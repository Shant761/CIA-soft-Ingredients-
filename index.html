<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üí∞ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä - Firebase</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            text-align: center;
        }
        
        .header h1 {
            color: #2d3748;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #718096;
            font-size: 1.1em;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .stat-card {
            text-align: center;
        }
        
        .stat-card h3 {
            color: #718096;
            font-size: 0.9em;
            text-transform: uppercase;
            margin-bottom: 10px;
        }
        
        .stat-card .amount {
            font-size: 2em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .income { color: #38a169; }
        .expense { color: #e53e3e; }
        .balance { color: #3182ce; }
        
        .quick-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .btn-primary {
            background: #4299e1;
            color: white;
        }
        
        .btn-success {
            background: #48bb78;
            color: white;
        }
        
        .btn-danger {
            background: #f56565;
            color: white;
        }
        
        .btn-ghost {
            background: transparent;
            color: #4299e1;
            border: 2px solid #4299e1;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .transactions-section {
            margin-top: 20px;
        }
        
        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #e2e8f0;
            transition: background 0.3s ease;
        }
        
        .transaction-item:hover {
            background: #f7fafc;
        }
        
        .transaction-info {
            flex-grow: 1;
        }
        
        .transaction-title {
            font-weight: 600;
            color: #2d3748;
        }
        
        .transaction-category {
            color: #718096;
            font-size: 0.9em;
        }
        
        .transaction-amount {
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .income-badge {
            color: #38a169;
        }
        
        .expense-badge {
            color: #e53e3e;
        }
        
        .transaction-date {
            color: #a0aec0;
            font-size: 0.8em;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
        }
        
        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            width: 90%;
            max-width: 500px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #4a5568;
            font-weight: 600;
        }
        
        .form-control {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #4299e1;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            background: white;
            border-radius: 10px;
            padding: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .tab.active {
            background: #4299e1;
            color: white;
        }
        
        .close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 1.5em;
            cursor: pointer;
            color: #718096;
        }
        
        .firebase-status {
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
            font-weight: 600;
        }
        
        .connected {
            background: #c6f6d5;
            color: #22543d;
        }
        
        .disconnected {
            background: #fed7d7;
            color: #742a2a;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #718096;
        }
        
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .quick-actions {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –®–∞–ø–∫–∞ -->
        <div class="header">
            <h1>üí∞ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä</h1>
            <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–∞–º–∏ –∏ —Ä–∞—Å—Ö–æ–¥–∞–º–∏ —Å Firebase</p>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å —Å—Ç–∞—Ç—É—Å–∞ Firebase -->
        <div class="card">
            <div class="firebase-status disconnected" id="firebaseStatus">
                üî¥ Firebase –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω
            </div>
            <div style="display: flex; gap: 10px; margin-top: 10px;">
                <button class="btn btn-primary" id="connectFirebase">–ü–æ–¥–∫–ª—é—á–∏—Ç—å Firebase</button>
                <button class="btn btn-ghost" id="syncData">–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
        <div class="dashboard">
            <!-- –ë–∞–ª–∞–Ω—Å -->
            <div class="card stat-card">
                <h3>–û–±—â–∏–π –±–∞–ª–∞–Ω—Å</h3>
                <div class="amount balance" id="totalBalance">0 ‚ÇΩ</div>
                <p>–ù–∞ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç</p>
            </div>

            <!-- –î–æ—Ö–æ–¥—ã -->
            <div class="card stat-card">
                <h3>–î–æ—Ö–æ–¥—ã</h3>
                <div class="amount income" id="totalIncome">0 ‚ÇΩ</div>
                <p>–ó–∞ –≤—Å–µ –≤—Ä–µ–º—è</p>
            </div>

            <!-- –†–∞—Å—Ö–æ–¥—ã -->
            <div class="card stat-card">
                <h3>–†–∞—Å—Ö–æ–¥—ã</h3>
                <div class="amount expense" id="totalExpense">0 ‚ÇΩ</div>
                <p>–ó–∞ –≤—Å–µ –≤—Ä–µ–º—è</p>
            </div>

            <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
            <div class="card">
                <h3>–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
                <div class="quick-actions">
                    <button class="btn btn-success" onclick="showModal('income')">‚ûï –î–æ–±–∞–≤–∏—Ç—å –¥–æ—Ö–æ–¥</button>
                    <button class="btn btn-danger" onclick="showModal('expense')">‚ûñ –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥</button>
                    <button class="btn btn-primary" onclick="loadTransactions()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                    <button class="btn btn-ghost" onclick="clearAllData()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë</button>
                </div>
            </div>
        </div>

        <!-- –°–ø–∏—Å–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π -->
        <div class="card">
            <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</h3>
            <div class="transactions-section" id="transactionsList">
                <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π...</div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ -->
    <div id="transactionModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 id="modalTitle">–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é</h2>
            
            <div class="tabs">
                <div class="tab active" id="incomeTab" onclick="setTransactionType('income')">–î–æ—Ö–æ–¥</div>
                <div class="tab" id="expenseTab" onclick="setTransactionType('expense')">–†–∞—Å—Ö–æ–¥</div>
            </div>

            <form id="transactionForm">
                <div class="form-group">
                    <label for="amount">–°—É–º–º–∞ *</label>
                    <input type="number" id="amount" class="form-control" placeholder="0.00" step="0.01" required>
                </div>

                <div class="form-group">
                    <label for="description">–û–ø–∏—Å–∞–Ω–∏–µ *</label>
                    <input type="text" id="description" class="form-control" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏" required>
                </div>

                <div class="form-group">
                    <label for="category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
                    <select id="category" class="form-control" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                        <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã JavaScript -->
                    </select>
                </div>

                <div class="form-group">
                    <label for="date">–î–∞—Ç–∞</label>
                    <input type="date" id="date" class="form-control" required>
                </div>

                <div class="form-group">
                    <label for="note">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</label>
                    <textarea id="note" class="form-control" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è" rows="3"></textarea>
                </div>

                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
                </button>
            </form>
        </div>
    </div>

    <script>
        // üî• Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAzKU_mZSVJc6nJA1PTZcKuZ9e8SwuZKqU",
            authDomain: "georges-1c626.firebaseapp.com",
            projectId: "georges-1c626",
            storageBucket: "georges-1c626.firebasestorage.app",
            messagingSenderId: "490623110927",
            appId: "1:490623110927:web:48780c508f49b73497387a",
            measurementId: "G-N20JTJMKSL"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // State
        let currentUser = null;
        let transactions = [];
        let currentTransactionType = 'income';

        // Categories
        const categories = {
            income: ['–ó–∞—Ä–ø–ª–∞—Ç–∞', '–§—Ä–∏–ª–∞–Ω—Å', '–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏', '–ü—Ä–æ–¥–∞–∂–∏', '–ü–æ–¥–∞—Ä–∫–∏', '–î—Ä—É–≥–æ–µ'],
            expense: ['–ï–¥–∞', '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç', '–ñ–∏–ª—å–µ', '–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è', '–ó–¥–æ—Ä–æ–≤—å–µ', '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ', '–û–¥–µ–∂–¥–∞', '–î—Ä—É–≥–æ–µ']
        };

        // DOM Elements
        const firebaseStatus = document.getElementById('firebaseStatus');
        const connectFirebaseBtn = document.getElementById('connectFirebase');
        const syncDataBtn = document.getElementById('syncData');
        const totalBalance = document.getElementById('totalBalance');
        const totalIncome = document.getElementById('totalIncome');
        const totalExpense = document.getElementById('totalExpense');
        const transactionsList = document.getElementById('transactionsList');
        const transactionModal = document.getElementById('transactionModal');
        const transactionForm = document.getElementById('transactionForm');
        const categorySelect = document.getElementById('category');
        const amountInput = document.getElementById('amount');
        const descriptionInput = document.getElementById('description');
        const dateInput = document.getElementById('date');
        const noteInput = document.getElementById('note');

        // Set current date as default
        dateInput.value = new Date().toISOString().split('T')[0];

        // Firebase Authentication
        function initFirebase() {
            auth.signInAnonymously()
                .then((userCredential) => {
                    currentUser = userCredential.user;
                    updateFirebaseStatus(true);
                    loadTransactions();
                    showToast('Firebase –ø–æ–¥–∫–ª—é—á–µ–Ω —É—Å–ø–µ—à–Ω–æ!', 'success');
                })
                .catch((error) => {
                    console.error('–û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:', error);
                    updateFirebaseStatus(false);
                    showToast('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Firebase', 'error');
                });
        }

        function updateFirebaseStatus(connected) {
            if (connected) {
                firebaseStatus.textContent = 'üü¢ Firebase –ø–æ–¥–∫–ª—é—á–µ–Ω';
                firebaseStatus.className = 'firebase-status connected';
                connectFirebaseBtn.textContent = '–ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å';
            } else {
                firebaseStatus.textContent = 'üî¥ Firebase –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω';
                firebaseStatus.className = 'firebase-status disconnected';
                connectFirebaseBtn.textContent = '–ü–æ–¥–∫–ª—é—á–∏—Ç—å Firebase';
            }
        }

        // Transaction Management
        function addTransaction(transaction) {
            if (!currentUser) {
                showToast('–°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ Firebase', 'error');
                return;
            }

            const transactionData = {
                ...transaction,
                userId: currentUser.uid,
                createdAt: new Date().toISOString(),
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            };

            db.collection('transactions').add(transactionData)
                .then(() => {
                    showToast('–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ Firebase!', 'success');
                    closeModal();
                    loadTransactions();
                })
                .catch((error) => {
                    console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
                    showToast('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏', 'error');
                });
        }

        function loadTransactions() {
            if (!currentUser) {
                showToast('–°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ Firebase', 'error');
                return;
            }

            transactionsList.innerHTML = '<div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π...</div>';

            db.collection('transactions')
                .where('userId', '==', currentUser.uid)
                .orderBy('timestamp', 'desc')
                .limit(50)
                .get()
                .then((querySnapshot) => {
                    transactions = [];
                    let totalIncomeValue = 0;
                    let totalExpenseValue = 0;

                    querySnapshot.forEach((doc) => {
                        const transaction = {
                            id: doc.id,
                            ...doc.data()
                        };
                        transactions.push(transaction);

                        if (transaction.type === 'income') {
                            totalIncomeValue += parseFloat(transaction.amount);
                        } else {
                            totalExpenseValue += parseFloat(transaction.amount);
                        }
                    });

                    updateTotals(totalIncomeValue, totalExpenseValue);
                    renderTransactions();
                    showToast('–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ Firebase', 'success');
                })
                .catch((error) => {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
                    transactionsList.innerHTML = '<div class="loading">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</div>';
                    showToast('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö', 'error');
                });
        }

        function deleteTransaction(transactionId) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é?')) return;

            db.collection('transactions').doc(transactionId).delete()
                .then(() => {
                    showToast('–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∞', 'success');
                    loadTransactions();
                })
                .catch((error) => {
                    console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è:', error);
                    showToast('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏', 'error');
                });
        }

        function updateTotals(income, expense) {
            totalIncome.textContent = income.toFixed(2) + ' ‚ÇΩ';
            totalExpense.textContent = expense.toFixed(2) + ' ‚ÇΩ';
            totalBalance.textContent = (income - expense).toFixed(2) + ' ‚ÇΩ';
        }

        function renderTransactions() {
            if (transactions.length === 0) {
                transactionsList.innerHTML = '<div class="loading">–ù–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</div>';
                return;
            }

            let html = '';
            transactions.forEach(transaction => {
                const isIncome = transaction.type === 'income';
                const amountClass = isIncome ? 'income-badge' : 'expense-badge';
                const amountSign = isIncome ? '+' : '-';
                const date = new Date(transaction.createdAt).toLocaleDateString('ru-RU');

                html += `
                    <div class="transaction-item">
                        <div class="transaction-info">
                            <div class="transaction-title">${transaction.description}</div>
                            <div class="transaction-category">${transaction.category} ‚Ä¢ ${date}</div>
                            ${transaction.note ? `<div style="color: #718096; font-size: 0.8em; margin-top: 4px;">${transaction.note}</div>` : ''}
                        </div>
                        <div class="transaction-amount ${amountClass}">
                            ${amountSign}${parseFloat(transaction.amount).toFixed(2)} ‚ÇΩ
                        </div>
                        <button onclick="deleteTransaction('${transaction.id}')" class="btn" style="padding: 5px 10px; margin-left: 10px; background: #fed7d7; color: #c53030;">‚úï</button>
                    </div>
                `;
            });

            transactionsList.innerHTML = html;
        }

        // Modal Functions
        function showModal(type) {
            currentTransactionType = type;
            document.getElementById('modalTitle').textContent = 
                type === 'income' ? '–î–æ–±–∞–≤–∏—Ç—å –¥–æ—Ö–æ–¥' : '–î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥';
            
            // Update active tab
            document.getElementById('incomeTab').classList.toggle('active', type === 'income');
            document.getElementById('expenseTab').classList.toggle('active', type === 'expense');
            
            // Update categories
            categorySelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>';
            const currentCategories = categories[type];
            currentCategories.forEach(category => {
                categorySelect.innerHTML += `<option value="${category}">${category}</option>`;
            });
            
            transactionModal.style.display = 'block';
        }

        function closeModal() {
            transactionModal.style.display = 'none';
            transactionForm.reset();
            dateInput.value = new Date().toISOString().split('T')[0];
        }

        function setTransactionType(type) {
            currentTransactionType = type;
            showModal(type);
        }

        // Form Submission
        transactionForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const transaction = {
                type: currentTransactionType,
                amount: parseFloat(amountInput.value),
                description: descriptionInput.value,
                category: categorySelect.value,
                date: dateInput.value,
                note: noteInput.value
            };

            addTransaction(transaction);
        });

        // Clear all data
        function clearAllData() {
            if (!confirm('–í–ù–ò–ú–ê–ù–ò–ï! –≠—Ç–æ —É–¥–∞–ª–∏—Ç –í–°–ï –≤–∞—à–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) return;

            if (!currentUser) {
                showToast('–°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ Firebase', 'error');
                return;
            }

            // Get all user transactions and delete them
            db.collection('transactions')
                .where('userId', '==', currentUser.uid)
                .get()
                .then((querySnapshot) => {
                    const batch = db.batch();
                    querySnapshot.forEach((doc) => {
                        batch.delete(doc.ref);
                    });
                    return batch.commit();
                })
                .then(() => {
                    showToast('–í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã', 'success');
                    loadTransactions();
                })
                .catch((error) => {
                    console.error('–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏:', error);
                    showToast('–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö', 'error');
                });
        }

        // Utility Functions
        function showToast(message, type) {
            // Create toast element
            const toast = document.createElement('div');
            toast.textContent = message;
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#48bb78' : '#f56565'};
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                z-index: 10000;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                animation: slideIn 0.3s ease;
            `;

            document.body.appendChild(toast);

            // Remove toast after 3 seconds
            setTimeout(() => {
                toast.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 3000);
        }

        // Add CSS for animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Event Listeners
        connectFirebaseBtn.addEventListener('click', initFirebase);
        syncDataBtn.addEventListener('click', loadTransactions);

        // Close modal when clicking outside
        window.addEventListener('click', function(e) {
            if (e.target === transactionModal) {
                closeModal();
            }
        });

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            initFirebase();
        });
    </script>
</body>
</html>